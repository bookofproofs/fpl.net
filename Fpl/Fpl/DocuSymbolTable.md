# Documentation of the FPL Symbol Table
## What is the FPL Symbol Table (ST)?
The ST is a pivotal data structure that the FPL interpreter constructs while traversing the abstract syntax tree (AST) generated by the FPL parser. It is a dynamic structure that undergoes state changes during the traversal. The FPL interpreter leverages the current state of the ST to emit diagnostics as it traverses the AST, making it an integral part of the interpreter's operation.

## Goal of this document
This document focuses on the ST's dynamic aspects and state changes that are not apparent from the code.

## Global Structure of the ST 
The F# type `SymbolTable` is defined in the `FplInterpreterTypes` module. It is a recursive tree structure of the F# type `FplValue` defined in the same module. Each node of the ST is of the `FplValue` type. 

Each FplValue object has properties allowing it to be embedded in the ST, the most important of which are:
* FplBlockType - A discriminated union type, determines the structure of FplValue, in particular how Scope, ArgList, and ValueList will be filled.
* FplId - a string identifying an FplValue in its Scope.
* Scope - implemented as a < string, FplValue >  dictionary, using the FplId  as key, and the corresponding FplValue as value. The Scope contains all related information of the FplValue that is unique, for instance, the Scope of a theory contains all unique FPL blocks, the Scope of an FPL block contains all unique variables of the block, the Scope of a Justification contains all unique justifications of an argument, and so one.
* ArgList - implemented as a < FplValue > list. It contains all arguments of the FplValue (if any). It is used to reflect the tree structure of expressions or signatures. It contains all values of the FplValue (if any) that are used for it *syntactical* representation. 
* ValueList - implemented as a < FplValue > list. It contains all values of the FplValue (if any) that are used for it *semantical* representation. 
* Parent - A parent node in this FplValue. It is FplValue that was constructed in the evaluation process of the AST recursively prior to the FplValue whose parent it is.

The following infos describe how the FplValues are related to each other using their Scope and their ArgList.

### FplBlockType `Root`
The root of the SymbolTable. Created in `FplInterpreterTypes.SymbolTable` constructor.
#### Possible Parent Nodes 
None 
#### Scope 
Contains `Theory` nodes of the FPL code being interpreted.
#### ArgList	
Empty
#### ValueList	
todo

---

### FplBlockType `Theory`
A theory node corresponds to each evaluated FPL file. Created in the `FplInterpreterBuildingBlocks.evaluateSymbolTable` function.
#### Possible Parent Nodes 
Root
#### Scope 
RuleOfInference, Class, FunctionaTerm, Predicate, Axiom, Theorem, Lemma, Proposition, Conjecture, Localization
#### ArgList	
Empty
#### ValueList	
todo

---


### FplBlockType `RuleOfInference`
An inference rule that is valid in the theory in which it was declared or theories using this theory. Created in `Ast.RuleOfInference`.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
1st Reference: A Reference to a premise predicate 
2nd Reference: A Reference to a vonclusion predicate
#### ValueList	
todo

---

### FplBlockType `Variable`
A variable declared in the scope of its Parent. Variables might be nested and have other Variables as parents. Created in `Ast.Var`.
#### Possible Parent Nodes 
RuleOfInference, Class, FunctionalTerm, Predicate, Axiom, Theorem, Lemma, Proposition, Conjecture, Localization, Corollary, Proof, Constructor, OptionalPredicate, MandatoryPredicate, OptionalFunctionalTerm, MandatoryFunctionalTerm, another Variable
#### Scope 
If a variable is declared with a class type, the scope will contain that class. It can also contain nested variables.
#### ArgList	
If a variable is assigned a value, the Object representing its value.
#### ValueList	
todo

---

### FplBlockType `VariadicVariableMany` and `VariadicVariableMany1`
A collection of 0 (or 1) to many variables or other variadic variables. Created in todo.
#### Possible Parent Nodes 
Same as possibble parents of the Variable node.
#### Scope 
todo
#### ArgList	
If list of Variable, VariadicVariableMany or VariadicVariableMany1
#### ValueList	
todo

---

### FplBlockType `Class`
A class defined in the theory or the theories using this theory. Created in `Ast.DefinitionClass`.
#### Possible Parent Nodes 
Theory
#### Scope 
Constructor, OptionalFunctionalTerm, MandatoryFunctionalTerm, OptionalPredicate, MandatoryPredicate, Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Class (list of nodes, from which this class inherits). These can be class nodes or primitive objects. Class nodes are only added if they were previously declared in the code while a primitive object is added when a it is the root a class inherits from.
#### ValueList	
todo

---

### FplBlockType `Constructor`
A class defined in the theory or the theories using this theory. Created in `Ast.DefinitionClass`.
#### Possible Parent Nodes 
Class
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent Class)
#### ArgList	
(Possibly empty) nodes that represent the calls to some base classes' constructors. Due to semantical errors in the code, the latter do not necessarily have to match the signatures of the actual constructors of the base classes of this constructor class.	The latter can be retrieved from the parent Class.
#### ValueList	
todo

---

### FplBlockType `Instance`
An instance of an FPL class that is assigned to a variable. Created in `Ast.Assignment`.
#### Possible Parent Nodes 
Variable
#### Scope 
None
#### ArgList	
Only a single value of an `Instance`. It may contain a ArgList with another `Instance` objects. These instances correspond to the classes from which the instantiated class inherits (see also FplBlockType `Class`).
#### ValueList	
todo

---

### FplBlockType `Index`
This block type represents the value of an inbuilt index type of FPL. Created in `Ast.DollarDigits` in case when DollarDigits is parsed in the context of a parsed Expression.
#### Possible Parent Nodes 
Reference
#### Scope 
None
#### ArgList	
None.
#### ValueList	
todo

---

### FplBlockType `FunctionalTerm`
A functional term defined in the theory or the theories using this theory. Created in `Ast.DefinitionFunctionalTerm`.
#### Possible Parent Nodes 
Theory
#### Scope 
OptionalFunctionalTerm, MandatoryFunctionalTerm, OptionalPredicate, MandatoryPredicate, Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
todo
#### ValueList	
todo

---

### FplBlockType `OptionalFunctionalTerm`
An optional property of its parent that is a functional term. Created in `Ast.FunctionalTermSignature`.
#### Possible Parent Nodes 
Class, Predicate, or FunctionalTerm
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent).
#### ArgList	
todo
#### ValueList	
todo

---

### FplBlockType `MandatoryFunctionalTerm`
A mandatory property of its parent that is a functional term. Created in `Ast.FunctionalTermSignature`.
#### Possible Parent Nodes 
Class, Predicate, or FunctionalTerm
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent).
#### ArgList	
todo
#### ValueList	
todo

---

### FplBlockType `Predicate`
A predicate defined in the theory or the theories using this theory. Created in `Ast.DefinitionPredicate`.
#### Possible Parent Nodes 
Theory
#### Scope 
OptionalFunctionalTerm, MandatoryFunctionalTerm, OptionalPredicate, MandatoryPredicate, Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Contains only one element: either a `Reference` that reflects the structure of an expression inside the `Predicate`'s block, or an `IntrisicPredicate`, which can be true, false, or undetermined.
#### ValueList	
A copy of the respective ArgList (only one element).

---

### FplBlockType `OptionalPredicate`
An optional property of its parent that is a predicate. Created in todo.
#### Possible Parent Nodes 
Class, Predicate, or FunctionalTerm
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent).
#### ArgList	
Contains only one element: either a `Reference` that reflects the structure of an expression inside the `OptionalPredicate`'s block, or an `IntrisicPredicate`, which can be true, false, or undetermined.
#### ValueList	
A copy of the respective ArgList (only one element).

---

### FplBlockType `MandatoryPredicate`
A mandatory property of its parent that is a predicate. Created in todo.
#### Possible Parent Nodes 
Class, Predicate, or FunctionalTerm
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent).
#### ArgList	
Contains only one element: either a `Reference` that reflects the structure of an expression inside the `MandatoryPredicate`'s block, or an `IntrisicPredicate`, which can be true, false, or undetermined.
#### ValueList	
A copy of the respective ArgList (only one element).

---

### FplBlockType `Axiom`
An axiom defined in the theory or the theories using this theory. Created in todo.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Contains only one element: either a `Reference` that reflects the structure of an expression inside the `Axiom`'s block, or an `IntrisicPredicate`, which can be true, false, or undetermined.
#### ValueList	
A copy of the respective ArgList (only one element).

---

### FplBlockType `Theorem`
A theorem defined in the theory or the theories using this theory. Created in todo.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Contains only one element: either a `Reference` that reflects the structure of an expression inside the `Theorem`'s block, or an `IntrisicPredicate`, which can be true, false, or undetermined.
#### ValueList	
A copy of the respective ArgList (only one element).

---

### FplBlockType `Lemma`
A lemma defined in the theory or the theories using this theory. Created in todo.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Contains only one element: either a `Reference` that reflects the structure of an expression inside the `Lemma`'s block, or an `IntrisicPredicate`, which can be true, false, or undetermined.
#### ValueList	
A copy of the respective ArgList (only one element).

---

### FplBlockType `Proposition`
A proposition defined in the theory or the theories using this theory. Created in todo.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Contains only one element: either a `Reference` that reflects the structure of an expression inside the `Proposition`'s block, or an `IntrisicPredicate`, which can be true, false, or undetermined.
#### ValueList	
A copy of the respective ArgList (only one element).

---

### FplBlockType `Conjecture`
A conjecture defined in the theory or the theories using this theory. Created in todo.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Contains only one element: either a `Reference` that reflects the structure of an expression inside the `Conjecture`'s block, or an `IntrisicPredicate`, which can be true, false, or undetermined.
#### ValueList	
A copy of the respective ArgList (only one element).

---

### FplBlockType `Corollary`
A corollary of its parent. Created in `Ast.Corollary`.
#### Possible Parent Nodes 
Axiom, Theorem, Lemma, Proposition, Conjecture, or Corollary
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1, including the scope of the parent
#### ArgList	
Contains only one element: either a `Reference` that reflects the structure of an expression inside the `Corollary`'s block, or an `IntrisicPredicate`, which can be true, false, or undetermined.
#### ValueList	
A copy of the respective ArgList (only one element).

---

### FplBlockType `Proof`
A proof of a provable statement (see Parent). Created in `Ast.Proof`.
#### Possible Parent Nodes 
Theorem, Lemma, Proposition, or Corollary
#### Scope 
Argument, Variable, VariadicVariableMany, VariadicVariableMany1, including the scope of the parent
#### ArgList	
Empty
#### ValueList	
If every `Argument` in the Scope can be inferred correctly, the ValueList will contain an `IntrisicPredicate` being true, otherwise being false. 

---

### FplBlockType `Argument`
An argument of a proof. Created in `Ast.Argument`.
#### Possible Parent Nodes 
Proof
#### Scope 
Empty
#### ArgList	
1st Justification, 
2nd ArgInference
#### ValueList	
todo

---

### FplBlockType `Justification`
One or more justifications to a proof argument. Created in `Ast.Justification`.
#### Possible Parent Nodes 
Argument
#### Scope 
Reference
#### ArgList	
Empty
#### ValueList	
todo

---

### FplBlockType `ArgInference`
An argument inference of a proof argument. Created in `Ast.AssumeArgument`, `Ast.RevokeArgument`, `Ast.DerivedPredicate`
#### Possible Parent Nodes 
Argument
#### Scope 
None
#### ArgList	
Reference
#### ValueList	
todo

---

### FplBlockType `Localization`
A localization defined in the theory or the theories using this theory. Created in `Ast.Localization`.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1, Translation
#### ArgList	
Reference to the expression for which this localization was declared.
#### ValueList	
todo

---

### FplBlockType `Translation`
A translation of an expression inside a Localization in a particular language. Created in `Ast.Translation`
#### Possible Parent Nodes 
Localization
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### FplBlockType `Language`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### FplBlockType `Reference`
A reference to another FplValue in the symbol table. Created in `Ast.Trivial`, `Ast.DottedPredicate`, `Ast.PredicateWithOptSpecification`, `Ast.IsOperator`, `Ast.Delegate`, `Ast.InfixOperation`, `Ast.Expression`, `Ast.Trivial`, `Ast.ParentConstructorCall`, `Ast.Assignment`
#### Possible Parent Nodes 
Constructor, Stmt, Reference
#### Scope 
By convention, if the scope contains an element with the same key as the node's FplId, then the value of the key-value pair is the referenced node.
#### ArgList	
May contain further Reference nodes.
#### ValueList	
todo

---

### FplBlockType `Object`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### FplBlockType `Quantor`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### FplBlockType `Mapping`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### FplBlockType `Stmt`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### FplBlockType `Assertion`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### FplBlockType `Extension`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

### FplBlockType `IntrinsicPredicate`
This 
#### Possible Parent Nodes 
todo
#### Scope 
Empty
#### ArgList	
Empty
#### ValueList	
Empty
