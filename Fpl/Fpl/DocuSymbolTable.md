# Documentation of the FPL Symbol Table
## What is the FPL Symbol Table
The symbol table (ST) is a pivotal data structure that the FPL interpreter constructs while traversing the abstract syntax tree (AST) generated by the FPL parser. It is a dynamic structure that undergoes state changes during the traversal. The FPL interpreter leverages the current state of the ST to emit diagnostics as it traverses the AST, making it an integral part of the interpreter's operation.

## Goal of this document
This document focuses on the ST's dynamic aspects and state changes that are not apparent from the code.

## Global Structure of the ST 
The F# type `SymbolTable` is defined in the `FplInterpreterTypes` module. It is a recursive tree structure of the F# type `FplValue` defined in the same module. Each node of the ST is of the `FplValue` type. 

Each FplValue object has different properties, the most important of which are:
* BlockType - implemented as FplBlockType that is a discriminated union type. FplValue.BlockType determines the structore of Scope, ArgList, and ValueList of the FplValue.
* Scope - implemented as a < key,value >  dictionary, using the Name attribute as key, and the corresponding FplValue as value. The scope contains all related information needed for the structure and semantics of the FplValue that is unique.
* FplId - a unique string used in the scope to identify the element. 
* ArgList - implemented as a list of FplValues. It contains all arguments of the FplValue (if any)
* ValueList - implemented as a list of FplValues. It contains all values of the FplValue (if any).
* Parent - A parent node in this FplValue, usually, the A's Parent references a B whose Scope contains the <A.Name, A> pair.

The following infos describe how the FplValues are related to each other using their Scope and their ArgList.

### BlockType `Root`
The root of the SymbolTable. Created in `FplInterpreterTypes.SymbolTable` constructor.
#### Possible Parent Nodes 
None 
#### Scope 
Contains `Theory` nodes of the FPL code being interpreted.
#### ArgList	
Empty
#### ValueList	
todo

---

### BlockType `Theory`
A theory node corresponds to each evaluated FPL file. Created in the `FplInterpreterBuildingBlocks.evaluateSymbolTable` function.
#### Possible Parent Nodes 
Root
#### Scope 
RuleOfInference, Class, FunctionaTerm, Predicate, Axiom, Theorem, Lemma, Proposition, Conjecture, Localization
#### ArgList	
Empty
#### ValueList	
todo

---


### BlockType `RuleOfInference`
An inference rule that is valid in the theory in which it was declared or theories using this theory. Created in `Ast.RuleOfInference`.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
1st Reference: A Reference to a premise predicate 
2nd Reference: A Reference to a vonclusion predicate
#### ValueList	
todo

---

### BlockType `Variable`
A variable declared in the scope of its Parent. Variables might be nested and have other Variables as parents. Created in `Ast.Var`.
#### Possible Parent Nodes 
RuleOfInference, Class, FunctionalTerm, Predicate, Axiom, Theorem, Lemma, Proposition, Conjecture, Localization, Corollary, Proof, Constructor, OptionalPredicate, MandatoryPredicate, OptionalFunctionalTerm, MandatoryFunctionalTerm, another Variable
#### Scope 
If a variable is declared with a class type, the scope will contain that class. It can also contain nested variables.
#### ArgList	
If a variable is assigned a value, the Object representing its value.
#### ValueList	
todo

---

### BlockType `VariadicVariableMany` and `VariadicVariableMany1`
A collection of 0 (or 1) to many variables or other variadic variables. Created in todo.
#### Possible Parent Nodes 
Same as possibble parents of the Variable node.
#### Scope 
todo
#### ArgList	
If list of Variable, VariadicVariableMany or VariadicVariableMany1
#### ValueList	
todo

---

### BlockType `Class`
A class defined in the theory or the theories using this theory. Created in `Ast.DefinitionClass`.
#### Possible Parent Nodes 
Theory
#### Scope 
Constructor, OptionalFunctionalTerm, MandatoryFunctionalTerm, OptionalPredicate, MandatoryPredicate, Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Class (list of nodes, from which this class inherits). These can be class nodes or primitive objects. Class nodes are only added if they were previously declared in the code while a primitive object is added when a it is the root a class inherits from.
#### ValueList	
todo

---

### BlockType `Constructor`
A class defined in the theory or the theories using this theory. Created in `Ast.DefinitionClass`.
#### Possible Parent Nodes 
Class
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent Class)
#### ArgList	
(Possibly empty) nodes that represent the calls to some base classes' constructors. Due to semantical errors in the code, the latter do not necessarily have to match the signatures of the actual constructors of the base classes of this constructor class.	The latter can be retrieved from the parent Class.
#### ValueList	
todo

---

### BlockType `Instance`
An instance of an FPL class that is assigned to a variable. Created in `Ast.Assignment`.
#### Possible Parent Nodes 
Variable
#### Scope 
None
#### ArgList	
Only a single value of an `Instance`. It may contain a ArgList with another `Instance` objects. These instances correspond to the classes from which the instantiated class inherits (see also BlockType `Class`).
#### ValueList	
todo

---

### BlockType `Index`
This block type represents the value of an inbuilt index type of FPL. Created in `Ast.DollarDigits` in case when DollarDigits is parsed in the context of a parsed Expression.
#### Possible Parent Nodes 
Reference
#### Scope 
None
#### ArgList	
None.
#### ValueList	
todo

---

### BlockType `FunctionalTerm`
A functional term defined in the theory or the theories using this theory. Created in `Ast.DefinitionFunctionalTerm`.
#### Possible Parent Nodes 
Theory
#### Scope 
OptionalFunctionalTerm, MandatoryFunctionalTerm, OptionalPredicate, MandatoryPredicate, Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `OptionalFunctionalTerm`
An optional property of its parent that is a functional term. Created in `Ast.FunctionalTermSignature`.
#### Possible Parent Nodes 
Class, Predicate, or FunctionalTerm
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent).
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `MandatoryFunctionalTerm`
A mandatory property of its parent that is a functional term. Created in `Ast.FunctionalTermSignature`.
#### Possible Parent Nodes 
Class, Predicate, or FunctionalTerm
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent).
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `Predicate`
A predicate defined in the theory or the theories using this theory. Created in `Ast.DefinitionPredicate`.
#### Possible Parent Nodes 
Theory
#### Scope 
OptionalFunctionalTerm, MandatoryFunctionalTerm, OptionalPredicate, MandatoryPredicate, Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `OptionalPredicate`
An optional property of its parent that is a predicate. Created in todo.
#### Possible Parent Nodes 
Class, Predicate, or FunctionalTerm
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent).
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `MandatoryPredicate`
A mandatory property of its parent that is a predicate. Created in todo.
#### Possible Parent Nodes 
Class, Predicate, or FunctionalTerm
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent).
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `Axiom`
An axiom defined in the theory or the theories using this theory. Created in todo.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Reference (only one, representing the axiom's predicate)
#### ValueList	
todo

---

### BlockType `Theorem`
A theorem defined in the theory or the theories using this theory. Created in todo.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Reference (only one, representing the theorems's predicate)
#### ValueList	
todo

---

### BlockType `Lemma`
A lemma defined in the theory or the theories using this theory. Created in todo.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Reference (only one, representing the lemmas's predicate)
#### ValueList	
todo

---

### BlockType `Proposition`
A proposition defined in the theory or the theories using this theory. Created in todo.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Reference (only one, representing the proposition's predicate)
#### ValueList	
todo

---

### BlockType `Conjecture`
A conjecture defined in the theory or the theories using this theory. Created in todo.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1
#### ArgList	
Reference (only one, representing the conjectures's predicate)
#### ValueList	
todo

---

### BlockType `Corollary`
A corollary of its parent. Created in `Ast.Corollary`.
#### Possible Parent Nodes 
Axiom, Theorem, Lemma, Proposition, Conjecture, or Corollary
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1, including the scope of the parent
#### ArgList	
Reference (only one, representing the corollary's predicate)
#### ValueList	
todo

---

### BlockType `Proof`
A proof of a provable statement (see Parent). Created in `Ast.Proof`.
#### Possible Parent Nodes 
Theorem, Lemma, Proposition, or Corollary
#### Scope 
Argument, Variable, VariadicVariableMany, VariadicVariableMany1, including the scope of the parent
#### ArgList	
Empty
#### ValueList	
todo

---

### BlockType `Argument`
An argument of a proof. Created in `Ast.Argument`.
#### Possible Parent Nodes 
Proof
#### Scope 
Empty
#### ArgList	
1st Justification, 
2nd ArgInference
#### ValueList	
todo

---

### BlockType `Justification`
One or more justifications to a proof argument. Created in `Ast.Justification`.
#### Possible Parent Nodes 
Argument
#### Scope 
Reference
#### ArgList	
Empty
#### ValueList	
todo

---

### BlockType `ArgInference`
An argument inference of a proof argument. Created in `Ast.AssumeArgument`, `Ast.RevokeArgument`, `Ast.DerivedPredicate`
#### Possible Parent Nodes 
Argument
#### Scope 
None
#### ArgList	
Reference
#### ValueList	
todo

---

### BlockType `Localization`
A localization defined in the theory or the theories using this theory. Created in `Ast.Localization`.
#### Possible Parent Nodes 
Theory
#### Scope 
Variable, VariadicVariableMany, VariadicVariableMany1, Translation
#### ArgList	
Reference to the expression for which this localization was declared.
#### ValueList	
todo

---

### BlockType `Translation`
A translation of an expression inside a Localization in a particular language. Created in `Ast.Translation`
#### Possible Parent Nodes 
Localization
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `Language`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `Reference`
A reference to another FplValue in the symbol table. Created in `Ast.Trivial`, `Ast.DottedPredicate`, `Ast.PredicateWithOptSpecification`, `Ast.IsOperator`, `Ast.Delegate`, `Ast.InfixOperation`, `Ast.Expression`, `Ast.Trivial`, `Ast.ParentConstructorCall`, `Ast.Assignment`
#### Possible Parent Nodes 
Constructor, Stmt, Reference
#### Scope 
By convention, if the scope contains an element with the same key as the node's FplId, then the value of the key-value pair is the referenced node.
#### ArgList	
May contain further Reference nodes.
#### ValueList	
todo

---

### BlockType `Object`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `Quantor`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `Mapping`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `Stmt`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `Assertion`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

---

### BlockType `Extension`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

### BlockType `Undefined`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo

### BlockType `Bool`
todo
#### Possible Parent Nodes 
todo
#### Scope 
todo
#### ArgList	
todo
#### ValueList	
todo
