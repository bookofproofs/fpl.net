# Documentation of the FPL Symbol Table
## What is the FPL Symbol Table
The symbol table (ST) is a pivotal data structure that the FPL interpreter constructs while traversing the abstract syntax tree (AST) generated by the FPL parser. It is a dynamic structure that undergoes state changes during the traversal. The FPL interpreter leverages the current state of the ST to emit diagnostics as it traverses the AST, making it an integral part of the interpreter's operation.

## Goal of this document
This document focuses on the ST's dynamic aspects and state changes that are not apparent from the code.

## Global Structure of the ST 
The F# type `SymbolTable` is defined in the `FplInterpreterTypes` module. It is a recursive tree structure of the F# type `FplValue` defined in the same module. Each node of the ST is of the `FplValue` type. 

Each FplValue object has different properties, the most important of which are:
* BlockType - implemented as FplValueType that is a discriminated union type
* Scope - implemented as a < key,value >  dictionary, using the Name attribute as key, and the corresponding FplValue as value.
* Name - a unique string used in the scope to identify the element. 
* ValueList - implemented as a list of FplValues. 
* Parent - A parent node in this FplValue, usually, the A's Parent references a B whose Scope contains the <A.Name, A> pair.


The following table documents how the FplValues are related to each other using their Scope and their ValueList.

| BlockType | Description | Created in (match in FplInterpreterBuildingBlocks.eval function if not stated otherwise)| Parent's BlockType | Possible Scope Elements | Possible ValueList Elements |
|----------|----------|----------|:----------:|:-------------:|:------:|
| Root | The root of the ST | `FplInterpreterTypes.SymbolTable` constructor | none | Theory | none |
| Theory  | A theory node corresponds to each evaluated FPL file. | `FplInterpreterBuildingBlocks.evaluateSymbolTable` function | Root | RuleOfInference, Class, FunctionaTerm, Predicate, Axiom, Theorem, Lemma, Proposition, Conjecture, Localization | none |
|RuleOfInference|An inference rule that is valid in the theory in which it was declared or theories using this theory.|`Ast.RuleOfInference`|Theory|Variable, VariadicVariableMany, VariadicVariableMany1||
|Class|A class defined in the theory or the theories using this theory.|`Ast.DefinitionClass`|Theory|Constructor, OptionalFunctionalTerm, MandatoryFunctionalTerm, OptionalPredicate, MandatoryPredicate, Variable, VariadicVariableMany, VariadicVariableMany1|Class (list of nodes, from which this class inherits) These can be class nodes or primitive objects. The values are only added if they were previously declared in the code.|
|FunctionalTerm|A functional term defined in the theory or the theories using this theory.|`Ast.DefinitionFunctionalTerm`|Theory|OptionalFunctionalTerm, MandatoryFunctionalTerm, OptionalPredicate, MandatoryPredicate, Variable, VariadicVariableMany, VariadicVariableMany1||
|Predicate|A predicate defined in the theory or the theories using this theory.|`Ast.DefinitionPredicate`|Theory|OptionalFunctionalTerm, MandatoryFunctionalTerm, OptionalPredicate, MandatoryPredicate, Variable, VariadicVariableMany, VariadicVariableMany1||
|Axiom|An axiom defined in the theory or the theories using this theory.||Theory|Variable, VariadicVariableMany, VariadicVariableMany1|Reference (only one, representing the axiom's predicate)|
|Theorem|A theorem defined in the theory or the theories using this theory.||Theory|Variable, VariadicVariableMany, VariadicVariableMany1|Reference (only one, representing the theorems's predicate)|
|Lemma|A lemma defined in the theory or the theories using this theory.||Theory|Variable, VariadicVariableMany, VariadicVariableMany1|Reference (only one, representing the lemmas's predicate)|
|Proposition|A proposition defined in the theory or the theories using this theory.||Theory|Variable, VariadicVariableMany, VariadicVariableMany1|Reference (only one, representing the proposition's predicate)|
|Conjecture|A conjecture defined in the theory or the theories using this theory.||Theory|Variable, VariadicVariableMany, VariadicVariableMany1|Reference (only one, representing the conjectures's predicate)|
|Localization|||Theory||Translation|
|Corollary|||Axiom, Theorem, Lemma, Proposition, Conjecture, or Corollary|||
|Proof|||Theorem, Lemma, Proposition, or Corollary|||
|Argument|||Proof|||
|Translation|||Localization|||
|Constructor|||Class|Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent Class)|(Possibly empty) Nodes that represent the calls to some base classes constructors. Due to semantical errors in the code, the latter do not necessarily have to match the signatures of the actual constructors of the base classes of this constructor class.	The latter can be retrieved from the parent Class.|
|Reference||||||
|OptionalFunctionalTerm||`Ast.FunctionalTermSignature`|Class, Predicate, or FunctionalTerm|Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent Class, Predicate, or FunctionalTerm)||
|OptionalPredicate|||Class, Predicate, or FunctionalTerm|Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent Class, Predicate, or FunctionalTerm)||
|MandatoryFunctionalTerm||`Ast.FunctionalTermSignature`|Class, Predicate, or FunctionalTerm|Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent Class, Predicate, or FunctionalTerm)||
|MandatoryPredicate|||Class, Predicate, or FunctionalTerm|Variable, VariadicVariableMany, VariadicVariableMany1 (in addition to the scope of the parent Class, Predicate, or FunctionalTerm)||
|Variable|A variable declared in the scope of its Parent. Variables might be nested and have other Variables as parents.|`Ast.Var`|RuleOfInference, Class, FunctionalTerm, Predicate, Axiom, Theorem, Lemma, Proposition, Conjecture, Localization, Corollary, Proof, Constructor, OptionalPredicate, MandatoryPredicate, OptionalFunctionalTerm, MandatoryFunctionalTerm, Variable|||
|VariadicVariableMany||||||
|VariadicVariableMany1||||||
|Object||||||
|Premise||||||
|Conclusion||||||
